on_actions = {
	on_startup = {
		effect = {
			# Game Rules - No Asia - Brazil N Mexicope
		# nuke
		if = {
			limit = {
				has_game_rule = {
					rule = no_asia_bra_mex_status
					option = MEX_BRA_REMOVED
				}
			}
			# Mexicope
			WST = {
				annex_country = { target = MEX transfer_troops = no }
			}
			# Brazil
			WST = {
				annex_country = { target = BRA transfer_troops = no }
			}
		}
		# ast annex
		if = {
			limit = {
				has_game_rule = {
					rule = no_asia_bra_mex_status
					option = MEX_BRA_ANNEXED_AST
				}
			}
			# Mexicope
			AST = {
				MEX = {
					every_unit_leader = {
						set_nationality = AST
					}
				}
				annex_country = { target = MEX transfer_troops = yes }
				add_state_core = 484
				add_state_core = 483
				add_state_core = 482
				add_state_core = 481
				add_state_core = 479
				add_state_core = 478
				add_state_core = 485
				add_state_core = 277
				add_state_core = 477
				add_state_core = 480
				add_state_core = 476
				add_state_core = 475
				add_state_core = 474
			}
			# Brazil
			AST = {
				BRA = {
					every_unit_leader = {
						set_nationality = AST
					}
				}
				annex_country = { target = BRA transfer_troops = yes }
				add_state_core = 495
				add_state_core = 497
				add_state_core = 498
				add_state_core = 505
				add_state_core = 499
				add_state_core = 504
				add_state_core = 501
				add_state_core = 500
				add_state_core = 503
				add_state_core = 502
				add_state_core = 280
				add_state_core = 496
			}
		}
		}
	}

	#Commonwealth Debuff for the AFRICA
	on_state_control_changed = {
		effect = {
			if = {
				limit = {
					FROM = { 
						OR = {
							is_in_faction_with = ENG 
							is_in_faction_with = USA 
							tag = ENG
							tag = USA
							tag = INS
							tag = FRA
						}
					}
					ROOT = { 
						OR = { 
							is_in_faction_with = GER 
							is_in_faction_with = JAP 
							tag = GER
							tag = JAP
							tag = VIC
							tag = ITA
						} 
					}
					FROM.FROM = {
						has_state_flag = AFRICA_COMMONWEALTH_controls
					}
				}
				FROM.FROM = {  
						set_state_flag = NOT_AFRICA_COMMONWEALTH_controls
						clr_state_flag = AFRICA_COMMONWEALTH_controls
				}
				if = {
					limit = {
					}
					every_country = {
						limit = {
							OR = {
								tag = FIN
								tag = GER
								tag = HUN
								tag = ITA
								tag = ROM
								tag = SPR
								tag = YUG
								tag = VIC
							}
						}
						AFRICA_COMMONWEALTH_AXIS_bases_level_down = yes
					}
				} else = {
					add_to_variable = {
						var = ITA.AFRICA_COMMONWEALTH_BASES_LEVEL
						value = 1
					}
				}

			}
		}
	}
	on_state_control_changed = {
		effect = {
			if = {
				limit = {
					FROM = { 
						OR = { 
							is_in_faction_with = GER 
							is_in_faction_with = JAP 
							tag = GER
							tag = JAP
							tag = ITA
							tag = VIC
						} 
					}
					ROOT = {
						OR = {
							is_in_faction_with = ENG 
							is_in_faction_with = USA 
							tag = ENG
							tag = FRA
							tag = USA
							tag = INS
						}
					}
					FROM.FROM = {
						has_state_flag = NOT_AFRICA_COMMONWEALTH_controls
					}
				}
				FROM.FROM = { 
						set_state_flag = AFRICA_COMMONWEALTH_controls
						clr_state_flag = NOT_AFRICA_COMMONWEALTH_controls
				}
				if = {
					limit = {
					}
					every_country = {
						limit = {
							OR = {
								tag = FIN
								tag = GER
								tag = HUN
								tag = ITA
								tag = ROM
								tag = SPR
								tag = YUG
								tag = VIC
							}
						}
						AFRICA_COMMONWEALTH_AXIS_bases_level_up = yes
					}
				} else = {
					subtract_from_variable = {
						var = ITA.AFRICA_COMMONWEALTH_BASES_LEVEL
						value = 1
						}
					}
				}
			}
		}
	
	### UK VOL WT REMOVAL ###
	on_weekly_SPR = {
        effect ={
			if ={
				limit = {
					has_global_flag = SPA_SCW_started_confirmed
					NOT = {
						has_global_flag = uk_spr_vols
					}
					NOT = {
						has_global_flag = SCW_over
					}
					SPD = {
						has_volunteers_amount_from = { tag = ENG count > 0 }
					}
				}
				set_global_flag = uk_spr_vols
				# add_threat = -1.2
				ENG = {
					add_named_threat = { threat = -1.2 name = "Removed World Tension from UK volunteers for balance reasons" }
				}
			}
		}
	} 

	### MAIN CONTROLL ###
	on_weekly_VEN = {
		effect={
			# sealion_core_defense=yes
			# update_academy_weekly=yes
			# update_sov_major_city_status = yes
			# set_variable={scaled_weekly_manpower=max_manpower_k}
			# multiply_variable={scaled_weekly_manpower=0.001}
			if = {
				limit = {
					date > 1941.1.1
					ITA = { surrender_progress > 0.80 }
					country_exists = ITA
					NOT = {
						has_global_flag = GER_ITA_spawn_ins_spawned
					}
				}
				GER = {	
					division_template = {
						name = "SS-Panzergrenadier"
						regiments = {
							medium_armor = { x = 0 y = 0 }
							medium_armor = { x = 0 y = 1 }
							medium_armor = { x = 0 y = 2 }
							medium_armor = { x = 0 y = 3 }
					
							medium_armor = { x = 1 y = 0 }
							medium_armor = { x = 1 y = 1 }
							medium_armor = { x = 1 y = 2 }
					
							mechanized = { x = 2 y = 0 }
							mechanized = { x = 2 y = 1 }
							mechanized = { x = 2 y = 2 }
					
							mechanized = { x = 3 y = 0 }
							mechanized = { x = 3 y = 1 }
							mechanized = { x = 3 y = 2 }
							mechanized = { x = 3 y = 3 }
					
							medium_tank_destroyer_brigade = { x = 4 y = 0 }
							medium_tank_destroyer_brigade = { x = 4 y = 1 }
					
						}
						support = {
							logistics_company = { x = 0 y = 0 }
							logistics_company_mot = { x = 0 y = 1 }
							mot_recon = { x = 0 y = 2 }
							mot_anti_air_brigade = { x = 0 y = 3 }
					
							ss_hq_company_medium = { x = 1 y = 0 }
							assault_engineer = { x = 1 y = 1 }
							signal_company = { x = 1 y = 2 }
							maintenance_company = { x = 1 y = 3 }
						}
					}	
					division_template = {
						name = "Infanterie Division Italien"
						division_names_group = GER_INF_01
						regiments = {
							infantry = { x = 0 y = 0 }
							infantry = { x = 0 y = 1 }
							infantry = { x = 0 y = 2 }
							infantry = { x = 0 y = 3 }
							infantry = { x = 1 y = 0 }
							infantry = { x = 1 y = 1 }
							infantry = { x = 1 y = 2 }
							infantry = { x = 1 y = 3 }
							infantry = { x = 2 y = 0 }
							infantry = { x = 2 y = 1 }
							infantry = { x = 2 y = 2 }
							artillery_brigade = { x = 3 y = 0 }
							artillery_brigade = { x = 3 y = 1 }
							artillery_brigade = { x = 3 y = 2 }
							artillery_brigade = { x = 3 y = 3 }
							anti_tank_brigade = { x = 4 y = 0 }
							anti_tank_brigade = { x = 4 y = 1 }
							anti_tank_brigade = { x = 4 y = 2 }
							anti_tank_brigade = { x = 4 y = 3 }
						}
						support = {
							hq_company = { x = 0 y = 0 } 
							engineer = { x = 0 y = 1 }   
							recon = { x = 0 y = 2 }
							logistics_company_mot  = { x = 0 y = 3 }
							anti_air = { x = 1 y = 0 }
						}
					}
 					153 = {
						for_loop_effect = {
							end = 4
							create_unit = {
								division = "name = \"SS-Panzergrenadier\" division_template = \"SS-Panzergrenadier\" start_experience_factor = 2.0"
								owner = GER
							}
						}
 						for_loop_effect = {
 							end = 20
 							create_unit = {
 								#prioritize_location =9135
 								division = "name = \"Infanterie Division Italien\" division_template = \"Infanterie Division Italien\" start_experience_factor = 0.2"
 								owner = GER
 							}
 						}
					}	
					set_global_flag = GER_ITA_spawn_ins_spawned
				}
			}
			every_country = {
				limit = {
					has_war = yes
					is_playable_country = yes
				}
				calculate_click_effect = yes
			}
		}
	}

	on_weekly_SOV = {
		effect = {
			if = {
				limit = {
					has_equipment = {
						convoy > 799
					}
				}
				set_temp_variable = { convoy_count = 0 }
				while_loop_effect = {
					limit = {
						has_equipment = {
							convoy > convoy_count
						}
					}
					add_to_temp_variable = { convoy_count = 100 }
				}
				if = {
					limit = {
						has_equipment = {
							convoy < convoy_count
						}
					}
					add_to_temp_variable = { convoy_count = -100 }
				}
				while_loop_effect = {
					limit = {
						has_equipment = {
							convoy > convoy_count
						}
					}
					add_to_temp_variable = { convoy_count = 10 }
				}
				if = {
					limit = {
						has_equipment = {
							convoy < convoy_count
						}
					}
					add_to_temp_variable = { convoy_count = -10}
				}
				while_loop_effect = {
					limit = {
						has_equipment = {
							convoy > convoy_count
						}
					}
					add_to_temp_variable = { convoy_count = 1 }
				}
				add_to_temp_variable = { convoy_count = -800 }
				set_temp_variable = { convoy_count2 = convoy_count }
				multiply_temp_variable = { convoy_count2 = -1 }
				add_equipment_to_stockpile = {
					type = convoy_1
					amount = convoy_count2
				}
				ENG = {
					add_equipment_to_stockpile = {
						type = convoy
						amount = SOV.convoy_count
					}
				}
			}
		}
	}

	on_naval_invasion = {
		effect = {
			if = {
				limit = {
					OR = {
						british_coastline = yes
					}
					OR = {
						ALL = {
							has_game_rule = {
								rule = sealion_auto_tp
								option = ENABLED
							}
							118 = {
								CONTROLLER = {
									tag = ENG
									is_in_faction_with = ENG
								}
							}
							446 = {
								CONTROLLER = {
									tag = ENG
									is_in_faction_with = ENG
								}
							}
						}
						has_global_flag = NO_ASIA
					}
				}
				teleport_armies = {
					limit = { 
						the_axis = yes  
					}
					to_state = FROM 
				}
				PREV = { 
					transfer_state_to = ENG
				} 	
			}
		}
	}

	on_paradrop = {
		effect = {
			if = {
				limit = {
					OR = {
						british_coastline = yes
					}
					OR = {
						ALL = {
							has_game_rule = {
								rule = sealion_auto_tp
								option = ENABLED
							}
							118 = {
								CONTROLLER = {
									tag = ENG
									is_in_faction_with = ENG
								}
							}
							446 = {
								CONTROLLER = {
									tag = ENG
									is_in_faction_with = ENG
								}
							}
						}
						has_global_flag = NO_ASIA
					}
				}
				teleport_armies = {
					limit = { 
						the_axis = yes  
					}
					to_state = FROM 
				}
				PREV = { 
					transfer_state_to = ENG
				} 	
			}
		}
	}
}